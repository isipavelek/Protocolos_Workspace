/*
 * API_rtc.c
 *
 *  Created on: 2 abr. 2023
 *      Author: ipave
 */

#include "API_rtc.h"


extern I2C_HandleTypeDef hi2c1;

void RTC_Write_Cal(reloj * reloj1){

	if(HAL_I2C_Mem_Write(&hi2c1,0x68<<1,0,I2C_MEMADD_SIZE_8BIT,(uint8_t *)reloj1,sizeof(reloj1),HAL_MAX_DELAY)!=HAL_OK)Error_Handler();

}

void RTC_Read_Cal(reloj * reloj1){
	if(HAL_I2C_Mem_Read(&hi2c1,0x68<<1,0,I2C_MEMADD_SIZE_8BIT,(uint8_t *)reloj1,sizeof(reloj1),HAL_MAX_DELAY)!=HAL_OK)Error_Handler();

}

void RTC_Write_Byte(uint8_t valor,uint8_t dir){

	uint8_t data[2];
	data[0]=dir;
	data[1]=valor;
	//0x68
	//if(HAL_I2C_Master_Transmit (&hi2c1,(0x68<<1),data, sizeof(data),HAL_MAX_DELAY)!=HAL_OK)Error_Handler();
	if(HAL_I2C_Mem_Write(&hi2c1,0x68<<1,0,I2C_MEMADD_SIZE_8BIT,(uint8_t *)reloj1,sizeof(reloj1),HAL_MAX_DELAY)!=HAL_OK)Error_Handler();

	//HAL_I2C_Master_Transmit (&hi2c1,0x68<<1,data, sizeof(data),HAL_MAX_DELAY);


}

void RTC_Read_Byte(uint8_t * valor,uint8_t dir){
	if(HAL_I2C_Mem_Read(&hi2c1,0x68<<1,dir,I2C_MEMADD_SIZE_8BIT,(uint8_t *)valor,1,HAL_MAX_DELAY)!=HAL_OK)Error_Handler();

}


